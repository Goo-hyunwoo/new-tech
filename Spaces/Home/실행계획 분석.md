# 실행 계획(Execution Plan)

SQL 구문을 처리하기 위해 사용되는 연산 방법이나 오브젝트를 읽어내는 순서 등이 조합된 일련의 처리 절차
>> 옵티마이저가 항상 최선의 실행 계획을 실행하는 것은 아니다.

### 실행 계획의 종류
1. 예상 실행 계획
   옵티마이저에 의해 선택될 가능성이 높은 실행 계획
2. 실제 실행 계획
    실제 쿼리에 사용된 실행 계획


### 인덱스 생성 / 삭제
```SQL
CREATE INDEX worldPoint_idx ON TB_WorldPoint (gid);
DROP INDEX worldPoint_idx ON TB_WorldPoint;
```

### 실행 계획 확인

1. 그래픽 예상 실행 계획 (SSMS) 

> SSMS에서 쿼리 작성 후, 우클릭, 중간에 예상 실행 계획 표시 실행
![[Pasted image 20240311163741.png]]

> 실행결과
![[Pasted image 20240311163816.png]]

2. 그래픽 실제 실행 계획 (SSMS)
> 위와 동일한 방식으로 쿼리 작성 후, 우클릭
> 실제 실행 계획 포함 선택 후, 쿼리 실행
![[Pasted image 20240311164139.png]]


3. 인덱스를 지우고 실행 계획을 확인해보면?
![[Pasted image 20240311164237.png]]


4. CLI 모드의 예상 실행 계획
```SQL
SET STATISTICS PROFILE ON/OFF;
```
> 인덱스가 없는 경우
![[Pasted image 20240311165231.png]]

> 인덱스가 있는 경우
![[Pasted image 20240311165327.png]]


5. CLI 모드의 실제 실행 통계 ( 단, 예상 실행 계획 모드가 ON인 경우는 사용 불가 )
> 실행 IO 표시, 실행 시간 표시 ( 메시지 부분에 표시됨 )
```SQL
SET STATISTICS IO ON/OFF;
SET STATISTICS TIME ON/OFF;
```

> 실행 결과 (IO / TIME ON)
![[Pasted image 20240311165425.png]]


### 참고 자료
MS 공식 문서
https://learn.microsoft.com/ko-kr/sql/relational-databases/performance/display-and-save-execution-plans?view=sql-server-ver16

티스토리 참고링크
https://earthteacher.tistory.com/219#gsc.tab=0

